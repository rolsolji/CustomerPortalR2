<!-- <vex-secondary-toolbar current="Form Wizard">
  <vex-breadcrumbs [crumbs]="['Forms', 'Form Wizard']" fxFlex="auto"></vex-breadcrumbs>

  <button class="ml-2" color="primary" mat-icon-button type="button">
    <mat-icon [icIcon]="icMoreVert"></mat-icon>
  </button>
</vex-secondary-toolbar> -->

<div @stagger class="qcForms p-gutter" vexContainer>  
  <div @fadeInUp class="card overflow-hidden">
    <div fxLayout="row" fxLayout.lt-md="column" fxLayoutGap="5px" class="LoadNumberSection" *ngIf="LoadNumber != null && LoadNumber.length > 0">
      <p>Load No: {{LoadNumber}}</p>
    </div>

    <mat-horizontal-stepper #stepper="matHorizontalStepper" [linear]="false" (selectionChange)="StepperSelectionChange($event)">
      <ng-template matStepperIcon="edit">
        <mat-icon [icIcon]="icDoneAll"></mat-icon>
      </ng-template>

      <ng-template matStepperIcon="done">
        <mat-icon [icIcon]="icDoneAll"></mat-icon>
      </ng-template>

      <mat-step [stepControl]="originAndDestinationFormGroup" errorMessage="Missing required fields.">
        <form [formGroup]="originAndDestinationFormGroup">
          <ng-template matStepLabel>
            <span class="stepTitleStyle">Origin And Destination</span>
          </ng-template>
          
          <div fxLayout="row" fxLayout.lt-md="column" fxLayoutGap="5px">
            <div @fadeInUp class="card" fxFlex="50%">
              <div fxLayout="row" fxLayoutGap="8px" class="ml-5">
                <div fxFlex="50%">
                  <div>
                    <h2 class="OriginDestinationTitle">Origin</h2>
                  </div>
                </div>
                <div fxFlex="50%" class="AddSaveToLocatonsSection">
                  <div>
                    <mat-checkbox [checked]="false" formControlName="addToLocationsOrigin" color="primary">Add to saved locations</mat-checkbox>
                  </div>
                </div>
              </div>
              <div>
                <div fxLayout="column" class="expansion-panel-cont-style">
                  <div fxLayout="row" fxLayout.lt-md="column" fxLayoutGap="5px">                    
                    <div fxFlex="100%">
                      <mat-form-field>
                        <mat-label>Name</mat-label>
                        <input name="originname" formControlName="originname" matInput maxlength="150" required >
                      </mat-form-field>
                    </div>                                 
                  </div>
                  <div fxLayout="row" fxLayout.lt-md="column" fxLayoutGap="5px">                    
                    <div fxFlex="50%">
                      <mat-form-field>
                        <mat-label>Address 1</mat-label>
                        <textarea name="originadddress1" formControlName="originadddress1" matInput required rows="2" maxlength="150"></textarea>
                      </mat-form-field>
                    </div>  
                    <div fxFlex="50%">
                      <mat-form-field>
                        <mat-label>Address 2</mat-label>
                        <textarea name="originadddress2" formControlName="originadddress2" matInput rows="2" maxlength="110"></textarea>
                      </mat-form-field>
                    </div>                                 
                  </div>     
                  <div fxLayout="row" fxLayout.lt-md="column" fxLayoutGap="5px">
                    <div fxFlex="50%">
                      <mat-form-field fxFlex="none">
                        <mat-label>Country</mat-label>                   
                          <mat-select  name="origincountry" formControlName="origincountry">
                          <mat-option *ngFor="let country of originCountries" [value]="country.CountryId">{{country.CountryName}}</mat-option>                      
                        </mat-select>
                      </mat-form-field>
                    </div>
                    <div fxFlex="50%">
                      <mat-form-field>
                        <mat-label>Postal Code</mat-label>
                        <input name="originpostalcode" formControlName="originpostalcode"
                                matInput required 
                                [matAutocomplete]="pcoAutoComplete"
                                (keydown.tab)="validateOriginPostalCode($event)">
                          <mat-autocomplete #pcoAutoComplete="matAutocomplete" (optionSelected)="pcoAutoCompleteSelected($event)">
                              <mat-option *ngFor="let option of pcoAutoCompleteOptions | async" [value]="option">
                                {{option.PostalCode}} - {{option.CityName}}
                                </mat-option>
                          </mat-autocomplete>       
                      </mat-form-field>
                    </div>                                 
                  </div>
                  <div fxLayout="row" fxLayout.lt-md="column" fxLayoutGap="5px">
                    <div fxFlex="50%">
                      <mat-form-field>
                        <mat-label>State</mat-label>
                        <input name="originstatename" matInput formControlName="originstatename" required>
                      </mat-form-field>
                    </div>                   
                  </div>
                  <div fxLayout="row" fxLayout.lt-md="column" fxLayoutGap="5px">                    
                    <div fxFlex="50%">
                      <mat-form-field>
                        <mat-label>Contact</mat-label>
                        <input name="origincontact" formControlName="origincontact" maxlength="110" matInput >
                      </mat-form-field>
                    </div>  
                    <div fxFlex="50%">
                      <mat-form-field>
                        <mat-label>Phone</mat-label>
                        <input name="originphone" formControlName="originphone" matInput maxlength="110" required >
                      </mat-form-field>
                    </div>                                 
                  </div>  
                  <div fxLayout="row" fxLayout.lt-md="column" fxLayoutGap="5px">                    
                    <div fxFlex="50%">
                      <mat-form-field>
                        <mat-label>Email</mat-label>
                        <input name="originemail" type="email" formControlName="originemail" maxlength="225" matInput >  
                        <div class="emailNotValid" *ngIf="originEmail.errors?.email">
                          Email format not valid
                        </div>                       
                      </mat-form-field>                      
                    </div>                                                  
                  </div>   
                  <!-- <div fxLayout="row" fxLayout.lt-md="column" fxLayoutGap="5px">                    
                    <div fxFlex="100%">
                      <mat-form-field class="matAreaInputField">
                        <mat-label>Notes</mat-label>                        
                        <mat-hint align="end">{{originnotes.value.length}} / 250</mat-hint>
                        <textarea #originnotes name="originnotes" formControlName="originnotes" matInput rows="2" maxlength="250"></textarea>                        
                      </mat-form-field>
                    </div>                        
                  </div>    -->
                  <div fxLayout="row" fxLayout.lt-md="column" fxLayoutGap="5px">                    
                    <div fxFlex="34%">
                      <mat-form-field>
                        <mat-label>Exp Pickup Date</mat-label>
                        <input (click)="formDatepickerRef.open()" (focus)="formDatepickerRef.open()" name="originpickupdate"
                          [matDatepicker]="formDatepickerRef" matInput readonly formControlName="originpickupdate">
                        <mat-datepicker-toggle [for]="formDatepickerRef" matSuffix></mat-datepicker-toggle>
                        <!-- <mat-hint>Click on the input or the datepicker icon</mat-hint> -->
                        <mat-datepicker #formDatepickerRef></mat-datepicker>
                      </mat-form-field>  
                    </div>  
                    <div fxFlex="32%">
                      <mat-form-field fxFlex="none">
                        <mat-label>Pickup Open</mat-label>                   
                          <mat-select  name="originpickupopen" formControlName="originpickupopen">
                            <mat-option *ngFor="let time of timesArray" [value]="time">{{time}}</mat-option>                      
                          </mat-select>
                      </mat-form-field>
                    </div> 
                    <div fxFlex="32%">
                      <mat-form-field fxFlex="none">
                        <mat-label>Pickup Close</mat-label>                   
                          <mat-select  name="originpickupclose" formControlName="originpickupclose">
                            <mat-option *ngFor="let time of timesArray" [value]="time">{{time}}</mat-option>
                        </mat-select>
                      </mat-form-field>
                    </div>                                 
                  </div>                                         
                </div>
              </div>
            </div>
            <div @fadeInUp class="card" fxFlex="50%">
              <div fxLayout="row" fxLayoutGap="8px" class="ml-5">
                <div fxFlex="50%" class="AddSaveToLocatonsSection">
                  <div><h2 class="OriginDestinationTitle">Destination</h2></div> 
                </div>                       
                <div fxFlex="50%" class="AddSaveToLocatonsSection">
                  <div>
                    <mat-checkbox [checked]="false" formControlName="addToLocationsDest" color="primary">Add to saved locations</mat-checkbox>
                  </div>
                </div>                        
              </div>
              <div>
                <div fxLayout="column" class="expansion-panel-cont-style">
                  <div fxLayout="row" fxLayout.lt-md="column" fxLayoutGap="5px">                    
                    <div fxFlex="100%">
                      <mat-form-field>
                        <mat-label>Name</mat-label>
                        <input name="destname" formControlName="destname" matInput maxlength="150" required >
                      </mat-form-field>
                    </div>                                 
                  </div>
                  <div fxLayout="row" fxLayout.lt-md="column" fxLayoutGap="5px">                    
                    <div fxFlex="50%">
                      <mat-form-field>
                        <mat-label>Address 1</mat-label>
                        <textarea name="destadddress1" formControlName="destadddress1" matInput required rows="2" maxlength="150"></textarea>
                      </mat-form-field>
                    </div>  
                    <div fxFlex="50%">
                      <mat-form-field>
                        <mat-label>Address 2</mat-label>
                        <textarea name="destadddress2" formControlName="destadddress2" matInput rows="2" maxlength="110"></textarea>
                      </mat-form-field>
                    </div>                                 
                  </div>     
                  <div fxLayout="row" fxLayout.lt-md="column" fxLayoutGap="5px">
                    <div fxFlex="50%">
                      <mat-form-field fxFlex="none">
                        <mat-label>Country</mat-label>                   
                          <mat-select  name="destcountry" formControlName="destcountry">
                          <mat-option *ngFor="let country of originCountries" [value]="country.CountryId">{{country.CountryName}}</mat-option>                      
                        </mat-select>
                      </mat-form-field>
                    </div>
                    <div fxFlex="50%">
                      <mat-form-field>
                        <mat-label>Postal Code</mat-label>
                        <input name="destpostalcode" formControlName="destpostalcode"
                                matInput required [matAutocomplete]="pcdAutoComplete"
                                (keydown.tab)="validateDestinationPostalCode($event)">
                                <mat-autocomplete #pcdAutoComplete="matAutocomplete" (optionSelected)="pcdAutoCompleteSelected($event)">
                                  <mat-option *ngFor="let option of pcdAutoCompleteOptions | async" [value]="option">
                                    {{option.PostalCode}} - {{option.CityName}}
                                  </mat-option>
                                </mat-autocomplete>
                      </mat-form-field>
                    </div>                                 
                  </div>
                  <div fxLayout="row" fxLayout.lt-md="column" fxLayoutGap="5px">
                    <div fxFlex="50%">
                      <mat-form-field>
                        <mat-label>State</mat-label>
                        <input name="deststatename" matInput formControlName="deststatename" required>
                      </mat-form-field>
                    </div>                   
                  </div>
                  <div fxLayout="row" fxLayout.lt-md="column" fxLayoutGap="5px">                    
                    <div fxFlex="50%">
                      <mat-form-field>
                        <mat-label>Contact</mat-label>
                        <input name="destcontact" formControlName="destcontact" maxlength="110" matInput >
                      </mat-form-field>
                    </div>  
                    <div fxFlex="50%">
                      <mat-form-field>
                        <mat-label>Phone</mat-label>
                        <input name="destphone" formControlName="destphone" maxlength="110" matInput required >
                      </mat-form-field>
                    </div>                                 
                  </div>  
                  <div fxLayout="row" fxLayout.lt-md="column" fxLayoutGap="5px">                    
                    <div fxFlex="50%">
                      <mat-form-field>
                        <mat-label>Email</mat-label>
                        <input name="destemail" type="email" formControlName="destemail" maxlength="225" matInput >
                        <div class="emailNotValid" *ngIf="destEmail.errors?.email">
                          Email format not valid
                        </div>  
                      </mat-form-field>
                    </div>                                                  
                  </div>   
                  <!-- <div fxLayout="row" fxLayout.lt-md="column" fxLayoutGap="5px">                    
                    <div fxFlex="100%">
                      <mat-form-field class="matAreaInputField">
                        <mat-label>Notes</mat-label>
                        <mat-hint align="end">{{destnotes.value.length}} / 250</mat-hint>
                        <textarea #destnotes name="destnotes" formControlName="destnotes" matInput rows="2" maxlength="250"></textarea>
                      </mat-form-field>
                    </div>                        
                  </div>    -->
                  <div fxLayout="row" fxLayout.lt-md="column" fxLayoutGap="5px">                    
                    <div fxFlex="34%">
                      <mat-form-field>
                        <mat-label>Exp Del Date</mat-label>
                        <input (click)="formDestDatepickerRef.open()" (focus)="formDestDatepickerRef.open()" name="destexpdeldate"
                          [matDatepicker]="formDestDatepickerRef" matInput readonly formControlName="destexpdeldate">
                        <mat-datepicker-toggle [for]="formDestDatepickerRef" matSuffix></mat-datepicker-toggle>
                        <!-- <mat-hint>Click on the input or the datepicker icon</mat-hint> -->
                        <mat-datepicker #formDestDatepickerRef></mat-datepicker>
                      </mat-form-field>  
                    </div>  
                    <div fxFlex="32%">
                      <mat-form-field>
                        <mat-label>Delivery Open</mat-label>
                        <input name="destdelapptfrom" formControlName="destdelapptfrom" matInput >
                      </mat-form-field>
                    </div> 
                    <div fxFlex="32%">
                      <mat-form-field>
                        <mat-label>Delivery Close</mat-label>
                        <input name="destdelapptto" formControlName="destdelapptto" matInput >
                      </mat-form-field>
                    </div>                                 
                  </div>                                         
                </div>
              </div>
            </div>
          </div>
                    
          <div class="actions" fxLayout="row" fxLayout.lt-md="column" fxLayoutAlign="end center" fxLayoutGap="5px">
            <button (click)="stepper.reset()" [disabled]="originAndDestinationFormGroup.pristine" color="primary" mat-button
                    type="button">Reset
            </button>
            <button  color="primary" mat-raised-button matStepperNext>Next
            </button>
          </div>
        </form>
      </mat-step>

      <mat-step [stepControl]="productsAndAccessorialsFormGroup" errorMessage="Missing required fields.">
        <form [formGroup]="productsAndAccessorialsFormGroup">
          <ng-template matStepLabel>
            <span class="stepTitleStyle">Products and Accessorials</span>
          </ng-template>

          <div fxLayout="row" fxLayout.lt-md="column" fxLayoutGap="5px">
            <div @fadeInUp class="card" fxFlex="75%">
              <div fxLayout="row" fxLayoutGap="8px" class="ml-5">
                <div><h2 class="OriginDestinationTitle">Product(s) <label class="QuantityLabel">{{formProducts.length}}</label></h2></div>
              </div>
              <div  [ngClass]="{'ProductsSection': formProducts.length >= 3}">
               <div formArrayName='products' *ngFor="let prod of formProducts.controls; let i = index" > 
                  <hr *ngIf="i > 0" >
                  <div [formGroupName]="i">
                    <div fxLayout="column" class="pt-5" class="expansion-panel-cont-style">
                      <div fxLayout="row" fxLayout.lt-md="column" fxLayoutGap="5px">
                        <div fxFlex="12%">
                          <mat-form-field fxFlex="none">
                            <mat-label>Pallet</mat-label>
                            <input matInput type="number" maxlength="4" min="0" formControlName="Pallets" required>
                          </mat-form-field>
                        </div>
                        <div fxFlex="12%">
                          <mat-form-field>
                            <mat-label>Pieces</mat-label>
                            <input matInput type="number" maxlength="4" min="0" formControlName="Pieces">
                          </mat-form-field>
                        </div>   
                        <div fxFlex="22%">
                          <mat-form-field>
                            <mat-label>Packages</mat-label>
                            <mat-select name="package" formControlName="PackageTypeID" required>
                              <mat-option *ngFor="let package of packageTypes" [value]="package.PackageTypeID">{{package.PackageType}}</mat-option>
                            </mat-select>
                          </mat-form-field>
                        </div>
                        <div fxFlex="22%">
                          <mat-form-field>
                            <mat-label>Class</mat-label>
                            <mat-select formControlName="ProductClass" required>
                              <mat-option value="50">50</mat-option>
                              <mat-option value="55">55</mat-option>
                              <mat-option value="50">60</mat-option>
                              <mat-option value="65">65</mat-option>
                              <mat-option value="70">70</mat-option>
                              <mat-option value="77.5">77.5</mat-option>
                              <mat-option value="85">85</mat-option>
                              <mat-option value="92.5">92.5</mat-option>
                              <mat-option value="100">100</mat-option>
                              <mat-option value="110">110</mat-option>
                              <mat-option value="125">125</mat-option>
                              <mat-option value="150">150</mat-option>
                              <mat-option value="175">175</mat-option>
                              <mat-option value="200">200</mat-option>
                              <mat-option value="250">250</mat-option>
                              <mat-option value="300">300</mat-option>
                              <mat-option value="400">400</mat-option>
                              <mat-option value="500">500</mat-option>
                            </mat-select>
                          </mat-form-field>
                        </div>                         
                        <div fxFlex="28%">
                          <mat-form-field>
                            <mat-label>Description</mat-label>
                            <input matInput type="text" maxlength="50" formControlName="ProductDescription" required>
                          </mat-form-field>
                        </div>     
                      </div>
        
                      <div fxLayout="row" fxLayout.lt-md="column" fxLayoutGap="5px">   
                        <div fxFlex="15%">
                          <mat-form-field>
                            <mat-label>NMFC</mat-label>
                            <input matInput maxlength="50" formControlName="NmfcNumber" required>                            
                          </mat-form-field>
                        </div>           
                        <div fxFlex="15%">
                          <mat-form-field>
                            <mat-label>L</mat-label>
                            <input matInput type="number" maxlength="4" min="0" formControlName="Length" required class="removeArrowsNumberInput">
                          </mat-form-field>
                        </div>  
                        <div fxFlex="15%">
                          <mat-form-field>
                            <mat-label>W</mat-label>
                            <input matInput type="number" maxlength="4" min="0" formControlName="Width" required class="removeArrowsNumberInput">
                          </mat-form-field>
                        </div>  
                        <div fxFlex="15%">
                          <mat-form-field>
                            <mat-label>H</mat-label>
                            <input matInput type="number" maxlength="4" min="0" formControlName="Height" required class="removeArrowsNumberInput">
                          </mat-form-field>
                        </div>
                        <div fxFlex="15%">
                          <mat-form-field>
                            <mat-label>PCF</mat-label>
                            <input matInput type="number" maxlength="4" min="0" formControlName="PCF" class="removeArrowsNumberInput">
                          </mat-form-field>
                        </div>
                        <div fxFlex="20%">
                          <mat-form-field>
                            <mat-label>Total Weight</mat-label>
                            <input matInput type="number" maxlength="4" min="0" formControlName="Weight" (change)="onChangeProductWeight(i)" required>
                          </mat-form-field>
                        </div>
                        
                      </div>
                      <div fxLayout="row" fxLayout.lt-md="column">  
                        <div fxFlex="27%" class="addToProductMaster">
                          <mat-checkbox [checked]="false" formControlName="addToProductMaster" color="primary">Add to my saved products</mat-checkbox>
                        </div>
                        <div fxFlex="15%">
                          <mat-checkbox [checked]="false" formControlName="Stackable" color="warn">Stackable</mat-checkbox>
                        </div>
                        <div fxFlex="15%">
                          <mat-checkbox [checked]="false" formControlName="Hazmat" color="warn">Hazmat</mat-checkbox>
                        </div>
                      </div> 
                      <div fxLayout="row" fxLayout.lt-md="column" fxLayoutGap="5px" class="pb-2 pt-2">                     
                        <div fxLayoutAlign="end center">
                          <ng-container *ngIf="formProducts.length > 1">
                            <button id="{{'remoeMinus'+i}}" (click)="removeNewProdField(i)" 
                                    mat-button type="button">Remove</button>
                          </ng-container>
                          <ng-container>
                            <button id="{{'addrec'+i}}" (click)="addNewProdField()" 
                                    mat-raised-button type="button" [disabled]="productsAndAccessorialsFormGroup.get('products').invalid" >Add New</button>
                          </ng-container>
                        </div>
                      </div>
                    </div>
                  </div>
                </div>
              </div>
            </div>
            <div @fadeInUp class="card" fxFlex="25%">
              <div fxLayout="row" fxLayoutGap="8px" class="ml-5">
                <div><h2 class="OriginDestinationTitle">Accessorial(s) <label class="QuantityLabel">{{accessorialsSelectedQty}}</label></h2></div>
              </div>
              <div class="AccessorialsSection">
                <mat-selection-list #accesorialsSelect class="accesorialsSelectionList" (selectionChange)="onGroupsChange(accesorialsSelect.selectedOptions.selected)">
                  <mat-list-option color="warn" *ngFor="let accesorial of accessorialArray" checkboxPosition="before" [value]="accesorial" [selected]="accesorial.Selected">
                    {{accesorial.Description}}
                  </mat-list-option>
                </mat-selection-list>
              </div>
            </div>
          </div>

          <div class="actions" fxLayout="row" fxLayoutAlign="end center" fxLayoutGap="8px">
            <button color="primary" mat-button matStepperPrevious type="button">Previous</button>
            <button  color="primary" mat-raised-button matStepperNext>Next</button>
          </div>
        </form>
      </mat-step>

      <mat-step [stepControl]="shipmentInfoFormGroup" errorMessage="Missing required fields.">
        <form [formGroup]="shipmentInfoFormGroup">
          <ng-template matStepLabel>
            <span class="stepTitleStyle">Shipment Information</span>
          </ng-template>
          <div fxLayout="row" fxLayout.lt-md="column" fxLayoutGap="5px">
            <div @fadeInUp class="card" fxFlex="50%">
              <div fxLayout="row" fxLayoutGap="8px" class="ml-5">
                <div><h2 class="OriginDestinationTitle">Shipment Information</h2></div>
              </div>
              <div>
                <div fxLayout="column" class="expansion-panel-cont-style">
                  <div fxLayout="row" fxLayout.lt-md="column" fxLayoutGap="5px">
                    <div fxFlex="50%">
                      <mat-form-field fxFlex="none">
                        <mat-label>Equipment</mat-label>                   
                          <mat-select  name="equipment" formControlName="equipment" (selectionChange)="selectChangeEquipment($event)">
                            <mat-option *ngFor="let equipment of EquipmentOptions" [value]="equipment.EquipmentID">{{equipment.Description}}</mat-option>
                        </mat-select>                        
                      </mat-form-field>
                    </div>                                                  
                  </div>
                  <div fxLayout="row" fxLayout.lt-md="column" fxLayoutGap="5px">                    
                    <div fxFlex="50%">
                      <mat-form-field fxFlex="none">
                        <mat-label>Priority</mat-label>                   
                          <mat-select  name="priority" formControlName="priority" (selectionChange)="selectChangePriority($event)">
                          <mat-option *ngFor="let priority of PriorityOptions" [value]="priority.PriorityID">{{priority.Description}}</mat-option>                      
                        </mat-select>
                      </mat-form-field>
                    </div>   
                    <div fxFlex="50%">
                      <mat-form-field fxFlex="none">
                        <mat-label>Service Level</mat-label>                   
                          <mat-select  name="servicelevel" formControlName="servicelevel" (selectionChange)="selectChangeServiceLevel($event)">
                          <mat-option *ngFor="let servicelevel of ServiceLevelOptions" [value]="servicelevel.ServiceLevelID">{{servicelevel.Description}}</mat-option>                      
                        </mat-select>
                      </mat-form-field>
                    </div>                              
                  </div>             
                  <div fxLayout="row" fxLayout.lt-md="column" fxLayoutGap="5px">
                    <div fxFlex="50%">
                      <mat-form-field>
                        <mat-label>{{ReferenceByClientField1}}</mat-label>
                        <input name="customerref" formControlName="customerref" matInput >
                      </mat-form-field>
                    </div>
                    <div fxFlex="50%">
                      <mat-form-field>
                        <mat-label>{{ReferenceByClientField2}}</mat-label>
                        <input name="r2order" formControlName="r2order" matInput >
                      </mat-form-field>
                    </div>                                 
                  </div>
                  <div fxLayout="row" fxLayout.lt-md="column" fxLayoutGap="5px">                  
                    <div fxFlex="50%">
                      <mat-form-field>
                        <mat-label>Shipment Value</mat-label>
                        <input name="shipmentvalue" maxlength="7" formControlName="shipmentvalue" matInput >
                      </mat-form-field>
                    </div> 
                    <div fxFlex="50%">
                      <mat-form-field>
                        <mat-label>Value Per Pound</mat-label>
                        <input name="valueperpound" type="number" maxlength="8" min="0" formControlName="valueperpound" matInput >
                      </mat-form-field>
                    </div>                                        
                  </div>                                   
                  <div fxLayout="row" fxLayout.lt-md="column" fxLayoutGap="5px">
                    <div fxFlex="100%">
                      <mat-form-field>
                        <mat-label>Special Instructions (to print in BOL)</mat-label>
                        <textarea name="specialinstructions" formControlName="specialinstructions" matInput rows="4" maxlength="250"></textarea>
                      </mat-form-field>
                    </div> 
                  </div> 
                                                                       
                </div>
              </div>              
            </div>
            <div @fadeInUp class="card" fxFlex="50%">
              <div fxLayout="row" fxLayoutGap="8px" class="ml-5">
                <div><h2 class="OriginDestinationTitle">Read Only - No Action Required</h2></div>
              </div>             
              <div>
                <div fxLayout="column" class="expansion-panel-cont-style"> 
                  <div fxLayout="row" fxLayout.lt-md="column" fxLayoutGap="5px">
                    <div fxFlex="50%">
                      <mat-form-field fxFlex="none">
                        <mat-label>Payment Terms</mat-label>                   
                          <mat-select  name="paymentterms" formControlName="paymentterms" (selectionChange)="selectChangePaymentTerm($event)">
                          <mat-option *ngFor="let paymentterm of PaymentTerms" [value]="paymentterm.PaymentTermID">{{paymentterm.Description}}</mat-option>                      
                        </mat-select>
                      </mat-form-field>
                    </div>
                    <div fxFlex="50%">
                      <mat-form-field>
                        <mat-label>Shipment Info</mat-label>
                        <input name="shipmentinfo" formControlName="shipmentinfo" matInput >
                      </mat-form-field>
                    </div>                                 
                  </div>
                  <div fxLayout="row" fxLayout.lt-md="column" fxLayoutGap="5px">
                    <div fxFlex="50%">
                      <mat-form-field>
                        <mat-label>Pro Number</mat-label>
                        <input name="pronumber" formControlName="pronumber" matInput >
                      </mat-form-field>
                    </div>
                    <div fxFlex="50%">
                      <mat-form-field fxFlex="none">
                        <mat-label>Mode</mat-label>                   
                          <mat-select  name="mode" formControlName="mode" (selectionChange)="selectChangeShipmentMode($event)">
                          <mat-option *ngFor="let modeItem of ShipmentModeOptions" [value]="modeItem.ModeCode">{{modeItem.Mode}}</mat-option>                      
                        </mat-select>
                      </mat-form-field>                     
                    </div>
                  </div>
                  <div fxLayout="row" fxLayout.lt-md="column" fxLayoutGap="5px">                    
                    <div fxFlex="50%">
                      <mat-form-field>
                        <mat-label>R2 Ref No</mat-label>
                        <input name="r2refno" formControlName="r2refno" matInput >
                      </mat-form-field>
                    </div>             
                    <div fxFlex="50%">
                      <mat-form-field>
                        <mat-label>{{ReferenceByClientField3}}</mat-label>
                        <input name="r2pronumber" formControlName="r2pronumber" matInput >
                      </mat-form-field>
                    </div>                                           
                </div>                       
                  <div fxLayout="row" fxLayout.lt-md="column" fxLayoutGap="5px">
                    <div fxFlex="75%">
                      <mat-form-field>
                        <mat-label>Internal Note</mat-label>
                        <textarea name="internalnote" matInput rows="3" formControlName="internalnote" maxlength="250"></textarea>
                      </mat-form-field>
                    </div> 
                    <div fxFlex="25%" class="centeredDivButton">
                      <button color="warn" class="button--small SubTypeButton" mat-raised-button type="button" (click)="addNewInternalNote()">Add Note</button>                             
                    </div> 
                  </div>
                  <div fxLayout="row" fxLayout.lt-md="column" fxLayoutGap="5px">
                    <div fxFlex="100%">
                      <mat-list>
                        <div mat-subheader *ngIf="showInternalNotesTitle">Notes</div>
                        <div class="NotesListSection">
                          <mat-list-item *ngFor="let note of internalNotes; let j = index">
                            <button mat-icon-button matTooltip="Delete Note" (click)="removeInternalNote(j)">
                              <mat-icon mat-list-icon color="warn">delete_forever</mat-icon>
                            </button>     
                            <mat-icon mat-list-icon>note</mat-icon>                     
                            <div mat-line>{{note.NoteText}}</div>
                            <div mat-line> {{note.Date | date}} - {{note.UserName}}</div>
                          </mat-list-item>    
                        </div>                                            
                      </mat-list>
                    </div>                     
                  </div>
                </div>
              </div>
            </div>
          </div>

          <div class="actions" fxLayout="row" fxLayoutAlign="end center" fxLayoutGap="8px">
            <button color="primary" mat-button matStepperPrevious type="button">Previous</button>
            <button  color="primary" mat-raised-button matStepperNext>Next
            </button>
          </div>
        </form>
      </mat-step>

      <mat-step [stepControl]="confirmFormGroup">
        <form [formGroup]="confirmFormGroup">
          <ng-template matStepLabel>
            <span class="stepTitleStyle">Rate Total and Book Shipment</span>
          </ng-template>

          <div fxLayout="row" fxLayout.lt-md="column" fxLayoutGap="5px">
            <div @fadeInUp class="card" fxFlex="40%">
              <div fxLayout="row" fxLayoutGap="8px" class="ml-5">
                <div><h2 class="OriginDestinationTitle">Summary</h2></div>
              </div>
              <div>
                <div fxLayout="column" class="expansion-panel-cont-style">
                  <div fxLayout="row" fxLayout.lt-md="column" fxLayoutGap="5px" >
                    <div fxFlex="50%">
                      <div fxLayout="row" fxLayout.lt-md="column" fxLayoutGap="5px">
                        <div fxFlex="100%">
                          <h3 class="OriginDestinationSubTitle">Origin</h3>
                        </div>                                                        
                      </div>
                      <div fxLayout="row" fxLayout.lt-md="column" fxLayoutGap="5px">
                        <div fxFlex="100%">
                          <mat-label>Name: </mat-label><mat-label class="InfoLabel">{{originAndDestinationFormGroup.get('originname').value}}</mat-label>
                        </div>                                                        
                      </div> 
                      <div fxLayout="row" fxLayout.lt-md="column" fxLayoutGap="5px">
                        <div fxFlex="100%">
                          <mat-label>Postal Code: </mat-label><mat-label class="InfoLabel">{{originAndDestinationFormGroup.get('originpostalcode').value}}</mat-label>
                        </div>                                                        
                      </div>
                      <div fxLayout="row" fxLayout.lt-md="column" fxLayoutGap="5px">
                        <div fxFlex="100%">
                          <mat-label>State: </mat-label><mat-label class="InfoLabel">{{originAndDestinationFormGroup.get('originstatename').value}}</mat-label>
                        </div>                                                        
                      </div>
                      <div fxLayout="row" fxLayout.lt-md="column" fxLayoutGap="5px">
                        <div fxFlex="100%">
                          <mat-label>Exp Pickup Date: </mat-label><mat-label class="InfoLabel">{{originPckupDate}}</mat-label>
                        </div>                                                        
                      </div>                                            
                    </div>
                    <div fxFlex="50%">
                      <div fxLayout="row" fxLayout.lt-md="column" fxLayoutGap="5px">
                        <div fxFlex="100%">
                          <h3 class="OriginDestinationSubTitle">Destination</h3>
                        </div>                                                        
                      </div>
                      <div fxLayout="row" fxLayout.lt-md="column" fxLayoutGap="5px">
                        <div fxFlex="100%">
                          <mat-label>Name: </mat-label><mat-label class="InfoLabel">{{originAndDestinationFormGroup.get('destname').value}}</mat-label>
                        </div>                                                        
                      </div>
                      <div fxLayout="row" fxLayout.lt-md="column" fxLayoutGap="5px">
                        <div fxFlex="100%">
                          <mat-label>Postal Code: </mat-label><mat-label class="InfoLabel">{{originAndDestinationFormGroup.get('destpostalcode').value}}</mat-label>
                        </div>                                                        
                      </div> 
                      <div fxLayout="row" fxLayout.lt-md="column" fxLayoutGap="5px">
                        <div fxFlex="100%">
                          <mat-label>State: </mat-label><mat-label class="InfoLabel">{{originAndDestinationFormGroup.get('deststatename').value}}</mat-label>
                        </div>                                                        
                      </div> 
                      <div fxLayout="row" fxLayout.lt-md="column" fxLayoutGap="5px">
                        <div fxFlex="100%">
                          <mat-label>Exp Del Date: </mat-label><mat-label class="InfoLabel">{{destExpDelDate}}</mat-label>
                        </div>                                                        
                      </div>
                    </div>                                 
                  </div>                  
                  <div fxLayout="row" fxLayout.lt-md="column" fxLayoutGap="5px">
                    <div fxFlex="100%" class="fake-link">                      
                      <span (click)="moveToStep(0)">edit</span>
                    </div>                                                   
                  </div>
                  <div fxLayout="row" fxLayout.lt-md="column" fxLayoutGap="5px">
                    <div fxFlex="100%">
                      <mat-divider></mat-divider>
                    </div>                                                   
                  </div>
                  <div fxLayout="row" fxLayout.lt-md="column" fxLayoutGap="5px" >
                    <div fxFlex="100%">
                      <h3 class="OriginDestinationSubTitle">Product(s): {{formProducts.length}}</h3>
                    </div>                    
                  </div>
                  <div fxLayout="row" fxLayout.lt-md="column" fxLayoutGap="5px">
                    <div style="width: 100%;">
                      <div *ngFor="let prod of formProducts.value; let i = index">
                        <hr *ngIf="i > 0" >
                        <div fxLayout="row" fxLayout.lt-md="column" fxLayoutGap="5px">
                          <div fxFlex="33.33%">
                            <div fxLayout="row" fxLayout.lt-md="column" fxLayoutGap="5px">
                              <div fxFlex="100%">
                                <mat-label>Pallet: </mat-label><mat-label class="InfoLabel">{{prod.Pallets}}</mat-label>
                              </div>                                                        
                            </div>                         
                          </div>
                          <div fxFlex="33.33%">
                            <div fxLayout="row" fxLayout.lt-md="column" fxLayoutGap="5px">
                              <div fxFlex="100%">
                                <mat-label>Pieces: </mat-label><mat-label class="InfoLabel">{{prod.Pieces}}</mat-label>
                              </div>                                                        
                            </div>                        
                          </div>  
                          <div fxFlex="33.33%">
                            <div fxLayout="row" fxLayout.lt-md="column" fxLayoutGap="5px">
                              <div fxFlex="100%">
                                <mat-label>Packages: </mat-label><mat-label class="InfoLabel">{{prod.PackageTypeDescription}}</mat-label>
                              </div>                                                        
                            </div>                          
                          </div>
                        </div>
                        <div fxLayout="row" fxLayout.lt-md="column" fxLayoutGap="5px">
                          <div fxFlex="33.33%">
                            <div fxLayout="row" fxLayout.lt-md="column" fxLayoutGap="5px">
                              <div fxFlex="100%">
                                <mat-label>Class: </mat-label><mat-label class="InfoLabel">{{prod.ProductClass}}</mat-label>
                              </div>                                                        
                            </div>                         
                          </div>
                          <div fxFlex="33.33%">
                            <div fxLayout="row" fxLayout.lt-md="column" fxLayoutGap="5px">
                              <div fxFlex="100%">
                                <mat-label>NMFC: </mat-label><mat-label class="InfoLabel">{{prod.NmfcNumber}}</mat-label>                                
                              </div>                                                        
                            </div>                         
                          </div>  
                          <div fxFlex="33.33%">
                            <div fxLayout="row" fxLayout.lt-md="column" fxLayoutGap="5px">
                              <div fxFlex="100%">                                
                                <mat-label>PCF: </mat-label><mat-label class="InfoLabel">{{prod.PCF}}</mat-label>
                              </div>                                                        
                            </div>                         
                          </div>                            
                        </div>   
                        <div fxLayout="row" fxLayout.lt-md="column" fxLayoutGap="5px">
                          <div fxFlex="33.33%">
                            <div fxLayout="row" fxLayout.lt-md="column" fxLayoutGap="5px">
                              <div fxFlex="100%">
                                <mat-label>Length: </mat-label><mat-label class="InfoLabel">{{prod.Length}}</mat-label>
                              </div>                                                        
                            </div>                        
                          </div>  
                          <div fxFlex="33.33%">
                            <div fxLayout="row" fxLayout.lt-md="column" fxLayoutGap="5px">
                              <div fxFlex="100%">
                                <mat-label>Width: </mat-label><mat-label class="InfoLabel">{{prod.Width}}</mat-label>
                              </div>                                                        
                            </div>                          
                          </div>
                          <div fxFlex="33.33%">
                            <div fxLayout="row" fxLayout.lt-md="column" fxLayoutGap="5px">
                              <div fxFlex="100%">
                                <mat-label>Height: </mat-label><mat-label class="InfoLabel">{{prod.Height}}</mat-label>
                              </div>                                                        
                            </div>                          
                          </div>
                        </div>
                        <div fxLayout="row" fxLayout.lt-md="column" fxLayoutGap="5px">
                          <div fxFlex="66.66%">
                            <div fxLayout="row" fxLayout.lt-md="column" fxLayoutGap="5px">
                              <div fxFlex="100%">
                                <mat-label>Description: </mat-label><mat-label class="InfoLabel">{{prod.ProductDescription}}</mat-label>
                              </div>                                                        
                            </div>                        
                          </div>  
                          <div fxFlex="32.5%">
                            <div fxLayout="row" fxLayout.lt-md="column" fxLayoutGap="5px">
                              <div fxFlex="100%">
                                <mat-label>Total Weight: </mat-label><mat-label class="InfoLabel">{{prod.Weight}}</mat-label>
                              </div>                                                        
                            </div>                          
                          </div>                          
                        </div>                                             
                      </div>
                    </div>
                    
                    
                  </div>
                  <div fxLayout="row" fxLayout.lt-md="column" fxLayoutGap="5px">
                    <div fxFlex="100%" class="fake-link">                      
                      <span (click)="moveToStep(1)">edit</span>
                    </div>                                                   
                  </div>
                  <div fxLayout="row" fxLayout.lt-md="column" fxLayoutGap="5px">
                    <div fxFlex="100%">
                      <mat-divider></mat-divider>
                    </div>                                                   
                  </div>
                  <div fxLayout="row" fxLayout.lt-md="column" fxLayoutGap="5px" >
                    <div fxFlex="100%">
                      <h3 class="OriginDestinationSubTitle">Shipment Information</h3>
                    </div>                                                     
                  </div>
                  <div fxLayout="row" fxLayout.lt-md="column" fxLayoutGap="5px">
                    <div fxFlex="50%">
                      <mat-label>Equipment: </mat-label><mat-label class="InfoLabel">{{equimentDescriptionSelected}}</mat-label>
                    </div>
                    <div fxFlex="50%">
                      <mat-label>Priority: </mat-label><mat-label class="InfoLabel">{{priorityDescriptionSelected}}</mat-label>
                    </div>                                 
                  </div>
                  <div fxLayout="row" fxLayout.lt-md="column" fxLayoutGap="5px">
                    <div fxFlex="50%">
                      <mat-label>{{ReferenceByClientField1}}</mat-label><mat-label class="InfoLabel">{{shipmentInfoFormGroup.get('customerref').value}}</mat-label>
                    </div>
                    <div fxFlex="50%">
                      <mat-label>{{ReferenceByClientField2}}</mat-label><mat-label class="InfoLabel">{{shipmentInfoFormGroup.get('r2order').value}}</mat-label>
                    </div>                                 
                  </div>
                  <div fxLayout="row" fxLayout.lt-md="column" fxLayoutGap="5px">
                    <div fxFlex="50%">
                      <mat-label>Service Level: </mat-label><mat-label class="InfoLabel">{{serviceLevelDescriptionSelected}}</mat-label>
                    </div>
                    <div fxFlex="50%">
                      <mat-label>Payment Terms: </mat-label><mat-label class="InfoLabel">{{paymentTermDescriptionSelected}}</mat-label>
                    </div>                                 
                  </div>
                  <div fxLayout="row" fxLayout.lt-md="column" fxLayoutGap="5px">
                    <div fxFlex="50%">
                      <mat-label>Pro Number: </mat-label><mat-label class="InfoLabel">{{shipmentInfoFormGroup.get('pronumber').value}}</mat-label>
                    </div>
                    <div fxFlex="50%">
                      <mat-label>Mode: </mat-label><mat-label class="InfoLabel">{{shipmentModeDescriptionSelected}}</mat-label>
                    </div>                                 
                  </div>
                  <div fxLayout="row" fxLayout.lt-md="column" fxLayoutGap="5px">
                    <div fxFlex="100%" class="fake-link">                      
                      <span (click)="moveToStep(2)">edit</span>
                    </div>                                                   
                  </div>
                </div>
              </div>
            </div>
            <div @fadeInUp class="card" fxFlex="60%">
              <div fxLayout="row" fxLayoutGap="8px" class="ml-5">
                <div><h2 class="OriginDestinationTitle">Carrier Rate and Total</h2></div>
              </div>
              <div>
                <div class="fill-current">                   
                  <div class="spinnerSection text-center" *ngIf="getQuoteButtonClicked && showSpinner">
                    <div class="center-me">
                      <mat-progress-spinner diameter="50" color="warn" mode="indeterminate"></mat-progress-spinner>
                      <p>{{spinnerMessage}}</p>
                    </div>
                  </div>    
        
                  <div *ngIf="getQuoteButtonClicked && !showSpinner" class="text-center">
                    <div fxLayout="row" fxLayoutGap="8px" class="py-2 freightRatesView">                      
                      <div fxFlex="70%" class="ratesSectionTitle">
                        <div><h2 class="allRatesTab-labelText">ALL QUOTES ({{ratesCounter}})</h2></div>
                        <div *ngIf="ratesCounter == null || ratesCounter == 0" class="noRatesFoundText">
                          <label>{{noRatesFoundText}}</label>
                        </div>
                      </div>
                      <div fxFlex="30%" class="closeRatesSection">
                        <div>
                          <button mat-button class="button--small" type="button" (click)="clearRatesSection()">Close</button>           
                        </div>
                      </div>                        
                    </div>
        
                    <div *ngIf="ratesCounter > 0" class="ratesAccordionSection">
                      <mat-accordion class="rates-accordion" multi> 
                        <div *ngFor="let rate of ratesFiltered; let j = index">              
                          <mat-expansion-panel [expanded]="false" (opened)="addRateOpened(j)" (closed)="removeRateClosed(j)">
                            <mat-expansion-panel-header class="ratesAccordionExpansionHeader">
                             
                                <div class="call-outs-container">
                                  <div class="call-out freightRate-carrierInfo">
                                    <img src="{{carrierImageUrl}}{{rate.CarrierID}}&Ticket={{securityToken}}" alt="logo" width="80" height="40">
                                    
                                  </div>
                                  <div class="call-out freightRate-carrierInfo">
                                    <div>
                                      <div fxLayout="column">
                                        <div class="CarrierName">
                                          {{rate.CarrierName}} 
                                        </div>
                                        <div class="inlineButton">
                                          {{rate.ServiceLevel}} 
                                        </div>
                                      </div>                    
                                    </div>                  
                                  </div>
                                  <div class="call-out freightRate-rateInfo">
                                    <div>
                                      <div fxLayout="column">
                                        <div>
                                          <div fxFlex="10%" class="freightRate-rateInfo-icon">
                                            <mat-icon [icIcon]="icTwotoneCalendarToday"></mat-icon>                     
                                          </div>
                                          <div fxFlex="90%" class="freightRate-rateInfo-text">                    
                                             Est. {{rate.TransitTime}} Transit Day(s)
                                          </div>
                                        </div>
                                        <div>
                                          {{rate.ETA}}
                                        </div>
                                        <div>
                                          Carrier Type: {{rate.CarrierType}}
                                        </div>
                                        <div>
                                          <hr />
                                        </div>
                                        <div>
                                          Max Weight: {{clientTLWeightLimit}}
                                        </div>
                                        <div>
                                          {{rate.MaxLenghtShipmentLimit}}
                                        </div>
                                        <div>
                                          {{rate.MaxHeightShipmentLimit}} 
                                        </div>
                                      </div>                    
                                    </div>    
                                    
                                  </div>
                                  <div class="call-out">
                                    <div>
                                      <div fxLayout="column">
                                        <div>
                                          <span id="{{'CarrierCostDiv'+ j}}" class="numeral numeral--large" [ngClass]="{'CarrierCostDivStyle': isRateOpened(j)}">
                                            <span class="numeral-affix numeral-affix--prefix">$</span>
                                            {{rate.TotalCostWithOutTrueCost}}
                                          </span>
                                        </div>
                                        <div>                 
                                          <button color="warn" class="button--small" mat-raised-button type="button" (click)="selectQuote(j)">Select</button>           
                                        </div>
                                      </div>
                                    </div>                                          
                                  </div>                          
                                </div>
                                
                            </mat-expansion-panel-header>
                            <div>
                              <div class="inner-rates-data-container">
                                <div class="inner-rate-column freightRate-rateInfo">
                                  <div fxLayout="column">
                                    <div>
                                      <b>Carrier Liability:</b> ${{rate.OldInsuranceCost}}/${{rate.NewInsuranceCost}} Max
                                    </div>
                                    <div>
                                      Does Not Include Accessorial Restrictions or FAKS
                                    </div>
                                    <div>
                                      <hr />
                                    </div>
                                    <div>
                                      <b>Rate Type:</b> {{rate.RateType}}
                                    </div>
                                    <div>
                                      <b>Payment Type:</b> {{rate.PaymentType}}
                                    </div>                          
                                  </div>
                                </div>                                           
                                <div class="inner-rate-column freightRate-rateInfo">
                                  <div fxLayout="column">
                                    <div>
                                      <b>Discount:</b> ${{rate.Discount}}
                                    </div>
                                    <div>
                                      <b>Freight:</b> ${{rate.FreightCost}}
                                    </div>
                                    <div>
                                      <b>Fuel:</b> ${{rate.FuelCost}}
                                    </div>
                                  </div>                         
                                </div>
                                <div class="inner-rate-column freightRate-rateInfo"> 
                                  <div fxLayout="column">
                                    <div *ngFor="let accesorial of rate.Accessorials">
                                      <div>
                                        {{accesorial.AccessorialDescription}}: ${{accesorial.AccessorialCharge}}
                                      </div>                           
                                    </div> 
                                    <div>
                                      <b>Total Accesorial(s): ${{rate.TotalAccCostWithOutTrueCost}}</b>
                                    </div> 
                                  </div>                                                                         
                                </div>                     
                              </div>                      
                              <div class="inner-rates-options-container">
                                  <div class="inner-rate-options-column" [ngClass]="{'inner-rate-options-column_with_email_input': sendEmailClicked}">
                                    <button mat-icon-button matTooltip="Save Quote" (click)="saveQuote(j)">
                                      <mat-icon [icIcon]="outlineSave"></mat-icon>
                                    </button>
                                    <button mat-icon-button matTooltip="Print">
                                      <mat-icon [icIcon]="outlinePrint"></mat-icon>
                                    </button>
                                    <button mat-icon-button matTooltip="Send Email" (click)="sendEmailClicked = true">
                                      <mat-icon [icIcon]="outlineEmail"></mat-icon>
                                    </button>
                                                                                                                   
                                  </div>
                                  <div class="inner-rate-options-column sendEmailInputStyle" *ngIf="sendEmailClicked">
                                    <form [formGroup]="emailFormGroup">
                                      <div >
                                        <mat-form-field appearance="standard" color="primary" style="width: 75%;" >
                                          <mat-label>Email</mat-label>
                                          <input matInput name="emailToSendQuote" required formControlName="emailToSendQuote">
                                        </mat-form-field>
                                       
                                        <div>
                                          <button color="primary" class="mr-1 mat-stroked-sent-email-button" mat-stroked-button type="button"  [disabled]="emailFormGroup.invalid" (click)="sendEmailClicked = false">Send</button>
                                          <button color="primary"  class="mat-stroked-sent-email-button" mat-stroked-button type="button" (click)="sendEmailClicked = false">Cancel</button>                                   
                                        </div>
                                      </div>                                                            
                                    </form>
                                  </div>
                              </div>
                              <hr class="rateAddressesSplitLine" />
                              <div class="inner-rates-addresses-container">                        
                                <div class="inner-rate-addresses-column">
                                  <div fxLayout="column">
                                    <div>
                                      Origin Term: {{rate.OriginTerminalCity}} | {{rate.OriginTerminalAddress1}} | {{rate.OriginTerminalCity}} {{rate.OriginTerminalState}} {{rate.OriginTerminalZip}} | (Ph.) {{rate.OriginTerminalPhoneNo}} | (Free Ph.) {{rate.OriginTerminalFreePhone}} | (Fax) {{rate.OriginTerminalFaxNo}}
                                    </div>
                                    <div>
                                      Destination Term: {{rate.DestTerminalCity}} | {{rate.DestTerminalAddress1}} | {{rate.DestTerminalCity}} {{rate.DestTerminalState}} {{rate.DestTerminalZip}} | (Ph.) {{rate.DestTerminalPhoneNo}} | (Free Ph.) {{rate.DestTerminalFreePhone}}
                                    </div>
                                  </div>
                                  
                                </div>  
                              </div>   
                            </div>
                          </mat-expansion-panel>
                                                               
                        </div>
                      </mat-accordion>
                    </div>               
                        
                  </div>
                  
                  <ng-template [ngIf]="!getQuoteButtonClicked">              
                    <div fxLayout="column" class="expansion-panel-cont-style" >
                      <div fxLayout="row" fxLayout.lt-md="column" fxLayoutGap="5px" >
                        <div fxFlex="58%">
                          <mat-form-field appearance="outline" class="vex-flex-form-field" color="primary">
                            <mat-label>Carrier</mat-label>
                            <input name="carrier" formControlName="carrier"
                                    matInput [matAutocomplete]="carrierAutoComplete"
                                    (keydown.tab)="validateCarrier($event)" >
                                    <mat-autocomplete #carrierAutoComplete="matAutocomplete" (optionSelected)="carrierAutoCompleteSelected($event)">
                                      <mat-option *ngFor="let option of carrierAutoCompleteOptions | async" [value]="option">
                                        {{option.CarrierID}} - {{option.CarrierName}}
                                      </mat-option>
                                    </mat-autocomplete>
                          </mat-form-field>
                        </div>
                        <div fxFlex="20%">
                          <mat-form-field appearance="outline" class="vex-flex-form-field" color="primary">
                            <mat-label>Show top Carriers</mat-label>
                            <input matInput type="number" maxlength="2" min="1" max="25" formControlName="showTopCarriers" required>
                          </mat-form-field>  
                        </div> 
                        <div fxFlex="22%" class="centeredDivButton">                      
                          <!-- <button (click)="getQuote()" color="warn" class="SubTypeButton" mat-raised-button type="button" [disabled]="true" >Rate Shipment</button> -->
                          <button [disabled]=showSpinner (click)="getQuote()" color="warn" class="SubTypeButton" mat-raised-button type="button" >Rate Shipment</button>
                        </div>                                 
                      </div>
                      <div>
                        <table mat-table [dataSource]="this.costListFiltered" class="mat-elevation-z8">                    
                          <ng-container matColumnDef="Code">
                            <th mat-header-cell *matHeaderCellDef> Code </th>
                            <td mat-cell *matCellDef="let shipmentItem"> {{shipmentItem.AccessorialCode}} </td>
                            <td mat-footer-cell *matFooterCellDef> Total </td>
                          </ng-container>
      
                          <ng-container matColumnDef="Description">
                            <th mat-header-cell *matHeaderCellDef> Description </th>
                            <td mat-cell *matCellDef="let shipmentItem"> {{shipmentItem.Description}} </td>
                            <td mat-footer-cell *matFooterCellDef>  </td>
                          </ng-container>
                                            
                          <ng-container matColumnDef="Amount">
                            <th mat-header-cell *matHeaderCellDef> Amount </th>
                            <td mat-cell *matCellDef="let shipmentItem"> {{shipmentItem.BilledCost | currency}} </td>
                            <td mat-footer-cell *matFooterCellDef> {{TotalShipmentCost | currency}} </td>
                          </ng-container>
                        
                          <tr mat-header-row *matHeaderRowDef="displayedCostGridColumns"></tr>
                          <tr mat-row *matRowDef="let row; columns: displayedCostGridColumns;"></tr>
                          <tr mat-footer-row *matFooterRowDef="displayedCostGridColumns"></tr>
                        </table>
                      </div>                  
                    </div>
                  </ng-template>
                 
                </div>


                
              </div>
            </div>
          </div>

          <div class="actions" fxLayout="row" fxLayoutAlign="end center" fxLayoutGap="8px">
            <button color="primary" mat-button matStepperPrevious type="button" (click)="previousFromLastStep()">Previous</button>
            <button (click)="SaveAsQuote()"  color="warn" mat-raised-button *ngIf="ShowSaveAsQuoteButton">
              Save as Quote
            </button>
            <button (click)="BookShipmentSubmit()"  color="warn" mat-raised-button
                    matStepperNext>
              Book Shipment
            </button>
          </div>
        </form>

      </mat-step>
    </mat-horizontal-stepper>
  </div>
 
</div>

